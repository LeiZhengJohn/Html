getwd()
setwd("D:/RFile/实验四")
#等位基因频率的Kappa一致性测量
x<-cbind(c(115,103),c(121,180))
x #查看回显
#加载vcd 库
library(vcd)
Kappa(x)
install.packages("vcd")
library(vcd)
library(vcd)
#等位基因频率的Kappa一致性测量
x<-cbind(c(115,103),c(121,180))
x #查看回显
#加载vcd 库
library(vcd)
Kappa(x)
#基因型频率的Kappa一致性测量
y<-cbind(c(17,197,4),c(48,146,107))
Kappa(y)
y
chisq.test(x,correct=F)
chisq.test(y,correct=F)
x<-c(121,180)
px<-c(52.9,47.1)
chisq.test(x, p = px, rescale.p = TRUE)
y<-c(48,146,107)
py<-c(7.8,90.4,1.8)
chisq.test(y, p = py, rescale.p = TRUE)
x<-c(121,180)
px<-c(52.9,47.1)
chisq.test(x, p = px, rescale.p = TRUE)
y<-c(48,146,107)
py<-c(7.8,90.4,1.8)
chisq.test(y, p = py, rescale.p = TRUE)
library(GEOquery)
gds4794 <- getGEO(filename='GDS4794.soft.gz')
#从数据类中提取所需数据表
data<-Table(gds4794)
#查看数据表的行、列数【实验结果中需要记录】
ncol(data)
#[1] 67
nrow(data)
#[1] 54675
#去除标题列的干扰【前两列】
data2<-data[,3:67]
#随机抽取2列数据
n=2
#得到列名称【标题行】
col.name=colnames(data2)
#按列随机抽样
sam.col.name = sample(col.name,n,replace=F)
#查看抽样结果
sam.col.name
#提取子数据集
sub.data <- data2[, sam.col.name]
#从数据类中提取所需数据表
data<-Table(gds4794)
#查看数据表的行、列数
ncol(data)
nrow(data)
#去除标题列的干扰【前两列】
data2<-data[,3:67]
#随机抽取2列数据
n=2
#得到列名称【标题行】
col.name=colnames(data2)
#按列随机抽样
sam.col.name = sample(col.name,n,replace=F)
#查看抽样结果
sam.col.name
#提取子数据集
sub.data <- data2[, sam.col.name]
# 把sub.data 从大到小分成 10 个区间进行频数统计
freq = matrix(rep(0,20),10,2) # 初始化频数矩阵
for(i in 1:2){
x <-table(as.numeric(cut(sub.data[,i],10)))
y <- as.data.frame(x)
freq[,i] <- y[,2]
}
colnames(freq)<-colnames(sub.data) # 列名
#卡方独立性检验/等比例检验：
chisq.test(freq,correct=F)
#卡方拟合优先度检验
x<- freq[,1]
p<-freq[,2]/sum(freq[,2])
chisq.test(x, p = p, rescale.p = TRUE)
