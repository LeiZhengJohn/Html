getwd()
setwd("D:/RFile/实验六")
library(GEOquery)
gds4794 <- getGEO(filename='GDS4794.soft.gz')
data<-Table(gds4794)
rownames(data)<-data[,1]
row.name = rownames(data)
n = 1
set.seed(1)
sam.row.name = sample(row.name,n,replace=F)
sam.row.name
a <- unlist(data[sam.row.name,3:67])
gene_name_a <- as.character(data[sam.row.name,2])
gene_name_a
p = NULL
cor = NULL
for(i in 1:nrow(data)){
b <- unlist(data[i,3:67])
x <- cor.test(a,b, method="pearson")
p <- c(p,x$p.value)
r <- c(r,x$estimate)
}
names(p)<-data[,2]
names(r)<-data[,2]
p = NULL
r = NULL
for(i in 1:nrow(data)){
b <- unlist(data[i,3:67])
x <- cor.test(a,b, method="pearson")
p <- c(p,x$p.value)
r <- c(r,x$estimate)
}
names(p)<-data[,2]
names(r)<-data[,2]
p_value = 0.05
r_cutoff = 0.5
p2 <- p[p<p_value]
r2 <- r[r>r_cutoff]
length(p2)
length(r2)
p_value = 0.01
r_cutoff = 0.6
p2 <- p[p<p_value]
r2 <- r[r>r_cutoff]
length(p2)
length(r2)
genes <- intersect(names(p2),names(r2))
length(genes)
tail(genes)
View(data)
genes["PCP2"]
genes2
genes
genes[-match("ARHGAP26",genes)]
length(genes)
genes2 <-c(gene_name_a,genes[1:645])
length(genes2)
tail(genes2)
head(genes)
head(genes2)
out = "pearson-related-genes"
write.table(genes2,out)
out = "pearson-related-genes.txt"
write.table(genes2,out)
View(data)
z <- c(2,3,5)
cor.test(z,z,method = "pearson")
