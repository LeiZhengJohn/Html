getwd()
gds4794 <- getGEO(filename='GDS4794.soft.gz')
setwd("D:/RFile/实验三")
library(GEOquery)
library(GEOquery)
gds4794 <- getGEO(filename='GDS4794.soft.gz')
#从数据类中提取所需数据表
data<-Table(gds4794)
#查看数据表的行、列数【实验结果中需要记录】
ncol(data)
#[1] 67
nrow(data)
#[1] 54675
#去除标题列的干扰【前两列】
data2<-data[,3:67]
#随机抽取1列数据
n=1
#得到列名称【标题行】
col.name=colnames(data2)
a <- data2[,"GSM1060787"]
a <- log(a)
x1<-min(a,na.rm=TRUE) # 计算最小值
x2<-max(a,na.rm=TRUE) # 计算最大值
ave<-mean(a,na.rm=TRUE) # 计算均值
med<-median(a,na.rm=TRUE) # 计算中位数
# 连续分布的众数定义为其分布的密度函数峰值对应的取值
ds=density(a,na.rm=TRUE)
mode <- ds$x[which.max(ds$y)]
quan<-quantile(a,na.rm=TRUE) # 计算四分位数 (0%,25%,50%,75%,100%)
dnorm_png<-png("d2-means-medium-mode.png") # 定义图片文档
hist(a, freq = F, breaks = 100) # 绘制频率分布直方图
curve(dnorm(x,mean(a,na.rm=TRUE), sd(a,na.rm=TRUE)), xlim=c(x1,x2),
col="blue", lwd=3, add=TRUE) # 绘制概率分布曲线
abline(v=ave,lty=3,lwd=3,col="red") # 增加均值线
abline(v=med,lty=3,lwd=3,col="purple") # 增加中位数线
abline(v=mode,lty=3,lwd=3,col="green") # 增加众数线
abline(v=quan,lty=3,lwd=3,col="blue") # 增加四分位数线
dev.off() # 保存图片文档
